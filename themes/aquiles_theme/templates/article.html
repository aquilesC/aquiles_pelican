{% extends "base.html" %}

{% block title %}{{ article.title }} | {{ SITENAME }}{% endblock %}

{% block description %}{{ article.summary|striptags|truncate(160) }}{% endblock %}

{% block extra_head %}
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="article" />
  <meta property="og:url" content="{{ SITEURL }}/{{ article.url }}" />
  <meta property="og:title" content="{{ article.title }}" />
  <meta property="og:description" content="{{ article.summary|striptags|truncate(200) }}" />
  <meta property="og:image" content="{{ SITEURL }}/images/og/{{ article.slug }}.png" />
  <meta property="og:site_name" content="{{ SITENAME }}" />
  {% if article.author %}
  <meta property="article:author" content="{{ article.author }}" />
  {% endif %}
  {% if article.date %}
  <meta property="article:published_time" content="{{ article.date.isoformat() }}" />
  {% endif %}
  {% if article.tags %}
  {% for tag in article.tags %}
  <meta property="article:tag" content="{{ tag.name }}" />
  {% endfor %}
  {% endif %}

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="{{ article.title }}" />
  <meta name="twitter:description" content="{{ article.summary|striptags|truncate(200) }}" />
  <meta name="twitter:image" content="{{ SITEURL }}/images/og/{{ article.slug }}.png" />

  <!-- Schema.org structured data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": "{{ article.title|e }}",
    "description": "{{ article.summary|striptags|truncate(200)|e }}",
    "image": "{{ SITEURL }}/images/og/{{ article.slug }}.png",
    "datePublished": "{{ article.date.isoformat() }}",
    {% if article.modified %}"dateModified": "{{ article.modified.isoformat() }}",{% else %}"dateModified": "{{ article.date.isoformat() }}",{% endif %}
    "author": {
      "@type": "Person",
      "name": "{{ article.author|default(AUTHOR)|e }}"
    },
    "publisher": {
      "@type": "Organization",
      "name": "{{ SITENAME|e }}"
    },
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "{{ SITEURL }}/{{ article.url }}"
    }{% if article.category %},
    "articleSection": "{{ article.category.name|e }}"{% endif %}{% if article.tags %},
    "keywords": "{{ article.tags|map(attribute='name')|join(', ')|e }}"{% endif %}
  }
  </script>
{% endblock %}

{% block content %}
  <article class="pt-xxl md:pt-[80px] pb-xxl">
    <!-- Hero Image -->
    {% if article.hero_image %}
    <div class="max-w-full mb-xxl">
      <img src="{{ SITEURL }}/{{ article.hero_image }}" alt="{{ article.title }}" class="w-full h-auto" />
      {% if article.hero_caption %}
      <p class="text-small text-text-secondary text-center mt-sm">{{ article.hero_caption }}</p>
      {% endif %}
    </div>
    {% endif %}

    <div class="max-w-content mx-auto px-lg">
      <!-- Article Header -->
      <header class="mb-xxl">
        {% if article.category %}
        <a href="{{ SITEURL }}/{{ article.category.url }}" class="text-overline text-accent uppercase tracking-wider mb-md inline-block hover:text-accentAlt hover:underline underline-offset-4 transition-colors">
          {{ article.category }}
        </a>
        {% endif %}
        <h1 class="text-h1 mb-md">{{ article.title }}</h1>
        
        {% if article.summary %}
        <p class="text-h4 text-text-secondary mb-lg">{{ article.summary }}</p>
        {% endif %}
        
        <!-- Meta Information -->
        <div class="flex flex-wrap items-center gap-md text-small text-text-secondary">
          <time datetime="{{ article.date.isoformat() }}">{{ article.locale_date }}</time>
          {% if article.readingtime %}
          <span>•</span>
          <span>{{ article.readingtime }} min read</span>
          {% endif %}
          {% if article.author %}
          <span>•</span>
          <span>By {{ article.author }}</span>
          {% endif %}
          {% if article.tags %}
          <span>•</span>
          <div class="flex flex-wrap gap-xs items-center">
            {% for tag in article.tags %}
            <a href="{{ SITEURL }}/{{ tag.url }}" class="inline-flex items-center gap-xs px-sm py-xs bg-muted-bg text-text-secondary hover:bg-accent hover:text-white rounded-full transition-colors text-overline">
              <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path>
              </svg>
              <span>{{ tag.name }}</span>
            </a>
            {% endfor %}
          </div>
          {% endif %}
        </div>
      </header>

      <!-- Article Content -->
      <div class="article-content">
        {{ article.content }}
      </div>

      <!-- Share Buttons -->
      <div class="mt-xxl pt-xl border-t border-border">
        <h3 class="text-h4 mb-md">Share this article</h3>
        <div class="flex flex-wrap gap-md mb-lg">
          <a href="https://twitter.com/intent/tweet?url={{ SITEURL }}/{{ article.url }}&text={{ article.title|urlencode }}" 
             target="_blank" 
             rel="noopener noreferrer"
             class="btn btn-secondary">
            Twitter
          </a>
          <a href="https://www.linkedin.com/sharing/share-offsite/?url={{ SITEURL }}/{{ article.url }}" 
             target="_blank" 
             rel="noopener noreferrer"
             class="btn btn-secondary">
            Share on LinkedIn
          </a>
        </div>
        {% if LINKEDIN_USERNAME %}
        <div class="text-small text-text-secondary">
          <p class="mb-xs">Connect with me:</p>
          <a href="https://www.linkedin.com/in/{{ LINKEDIN_USERNAME }}" target="_blank" rel="noopener noreferrer" class="text-accent hover:text-accent-alt underline-offset-4 hover:underline">
            View my LinkedIn profile
          </a>
        </div>
        {% endif %}
      </div>
    </div>
  </article>
{% endblock %}

